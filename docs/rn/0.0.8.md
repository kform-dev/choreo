# Release 0.0.8

[ChangeLog](https://github.com/kform-dev/choreo/releases)

## Jinja2 template support

Choreo now allows support for `jina2 templating` as a software technology to build controllers. Here is an example how it can be used

in the reconciler folder of the choreo project or upstream project define a yaml file witht he reconciler name

e.g. device.kubenet.dev.interfaces.config.nokiasrl.yaml

For jinja2 templating you have a single `for` resource and a single `own` resource. The `for` resource represents the input for the `jinjatemplate` reconciler and the `own` resource represents the resource generated by the reconciler.

```yaml
apiVersion: choreo.kform.dev/v1alpha1
kind: Reconciler
# name can be inferred from the filename or from the for resource
spec: 
  for: 
    group: device.network.kubenet.dev
    version: v1alpha1
    kind: Interface
    selector: {}
  owns:
  - group: config.sdcio.dev
    version: v1alpha1
    kind: Config
```

Multiple templates can be used for the resource. Here is an example with 2 templates.
You always need a `main.jinja2` matching the prefix of the yaml file and than we allow to split the hydration logic over multiple templates or contain it in 1 template. The template designer should determine it strategy taken into account code maintainability.

e.g. device.kubenet.dev.interfaces.config.nokiasrl.main.jinja2 in this example

```yaml
{%- import 'interface.jinja2' interface -%}
apiVersion: config.sdcio.dev/v1alpha1
kind: Config
metadata:
  name: {{ metadata.name }}
  namespace: {{ metadata.namespace }}
  labels:
    config.sdcio.dev/targetName: {{ spec.node }}
    config.sdcio.dev/targetNamespace: {{ metadata.namespace }}
  ownerReferences:
  - apiVersion: {{ apiVersion }}
    controller: true
    kind: {{ kind }}
    name: {{ metadata.name }}
    uid: {{ metadata.uid }}
spec:
  priority: 10
  config:
  - path: /
    value: 
      {{ interface(spec) -}} 
```

the 2nd template referenced using the define logic in `jinja2templating`

e.g. device.kubenet.dev.interfaces.config.nokiasrl.interface.jinja2

```yaml
{%- macro interface(spec) export -%}
      interface:
      - name: {{ spec.name }}
        description: k8s-{{ spec.name }}
        admin-state: enable
    {%- if spec.vlanTagging %}
        vlan-tagging: true
    {%- endif %}
{%- endmacro %}
```

When you split the reconcilers over multiple templates you need to ensure the name of the yaml file matches the template file name(s).

